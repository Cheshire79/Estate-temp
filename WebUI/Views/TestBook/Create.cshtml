@using WebUI.Models
@model List<SelectListItem>

@{
    ViewBag.Title = "Create";
}

<h2>Create</h2>

SelectdBook
@using (Html.BeginForm())
{
    SelectList categories = new SelectList(Model, "Value", "Text", Model.First().Value);
    SelectList books = new SelectList(Model, "Value", "Text", Model.First().Value);

    SelectdBook selectdBook = new SelectdBook();
    @Html.DropDownListFor(model => selectdBook.CategoryId, categories as SelectList, new { @class = "form-control",@id = "selected_CategoryId", @onchange = "FillBooks1()" })


    @Html.DropDownList("CategoryId1", @Model, "-- Select Permit --", htmlAttributes: new {@class = "form-control", @onchange = "FillBooks()"})
    @Html.DropDownList("BookId", null, htmlAttributes: new {@class = "form-control"})

    @Html.DropDownListFor(model => selectdBook.BookId, books, new { @class = "form-control",@id = "selectd_BookId1"})

    <div class="form-group">
        <div class="col-md-offset-2 col-md-10">
            <input type="submit" value="Create" class="btn btn-default" />
        </div>
    </div>
}
    <script type="text/javascript">

        function FillBooks() {


            var CategoryId = $('#CategoryId1').val();
            //console.log(CategoryId);

            $.ajax({
                url: 'FillBooks',
                type: "GET",
                dataType: "JSON",
                data: { CategoryId: CategoryId },
                success: function (response) {
                    console.log(response);
                    $("#BookId").html("");
                    $.each(response, function (index, value) {
                        $("#BookId").append(
                            $('<option></option>').val(value.BookId).html(value.BookName));
                    });
                }
            });
        }

        function FillBooks1() {


            var CategoryId12 = $('#selected_CategoryId').val();
            //console.log(CategoryId);

            $.ajax({
                url: 'FillBooks',
                type: "GET",
                dataType: "JSON",
                data: { CategoryId1: CategoryId12 },
                success: function (response) {
                    console.log(response);
                    $("#selectd_BookId1").html("");
                    $.each(response, function (index, value) {
                        $("#selectd_BookId1").append(
                            $('<option></option>').val(value.BookId).html(value.BookName));
                    });
                }
            });
        }
    </script>