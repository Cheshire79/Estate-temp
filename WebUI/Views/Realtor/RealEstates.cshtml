@using System.Globalization
@using WebUI.Models
@model WebUI.Models.DataForRealtorView
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Index</h2>
@using (Html.BeginForm())
{
    ChoosenSearchParametrsForRealtorView searchParametersForRealtor = new ChoosenSearchParametrsForRealtorView();
    //var selected = Model.SearchParameters.Districts.FirstOrDefault();
    SelectList districts = new SelectList(Model.SearchParameters.Districts, "Id", "Name", Model.ChoosenSearchParametersForRealtor.DistrictId);
    SelectList roomsNumber = new SelectList(Model.SearchParameters.RoomNumbers, "Id", "Name", Model.ChoosenSearchParametersForRealtor.RoomNumber);
    SelectList sortedOrders = new SelectList(Model.SearchParameters.SortOrders, "Id", "Name", Model.ChoosenSearchParametersForRealtor.SortOrder);
    <div class="realtor-searchArea">
        <div class="title-right">
            Available  <span class="bold_orange">@Model.RealEstates.Count</span> apartments (<span class="bold_orange">4</span> pages)
        </div>
        <div class="title-main">
            Search parameters
        </div>
        <div class="content01">
            <div class="group01">
                <div class="span5">
                    <label class="input-mini-text">District</label>
                    @Html.DropDownListFor(model => searchParametersForRealtor.DistrictId, districts as SelectList, new { @class = "input-large" })
                </div>
                <div class="span5">
                    <label class="input-mini-text">Rooms amount</label>
                    @Html.DropDownListFor(model => searchParametersForRealtor.RoomNumber, roomsNumber as SelectList, new { @class = "input-large" })
                </div>
                <div class="span5-3">
                    <label>My own</label>
                    @Html.CheckBoxFor(model => searchParametersForRealtor.ShowOnlyMyOwn, new { @class = "input-mini" })
                </div>
            </div>
            <div class="group02">
                <div class="span3">
                    <label class="input-mini-text">Area</label>
                    <!--input name="flrfrom" value="" class="input-mini" type="text"-->
                    @Html.TextBoxFor(model => searchParametersForRealtor.AreaFrom, new { @class = "input-mini" })
                    <!--input name="flrto" value="" class="input-mini" type="text"-->
                    @Html.TextBoxFor(model => searchParametersForRealtor.AreaTo, new { @class = "input-mini" })
                </div>
                <div class="span3">
                    <label class="input-mini-text">Price</label>
                    @Html.TextBoxFor(model => searchParametersForRealtor.PriceFrom, "{0:#.#}", new { @class = "input-mini-price" })
                    @Html.TextBoxFor(model => searchParametersForRealtor.PriceTo, new { @class = "input-mini-price" })
                </div>
                <div class="span3">
                    <label class="input-mini-text">Floor</label>
                    @Html.TextBoxFor(model => searchParametersForRealtor.FloorFrom, new { @class = "input-mini" })
                    @Html.TextBoxFor(model => searchParametersForRealtor.FloorTo, new { @class = "input-mini" })
                </div>
                <div class="span3">
                    <label class="input-mini-text">Height</label>
                    @Html.TextBoxFor(model => searchParametersForRealtor.HeightFrom, new { @class = "input-mini" })
                    @Html.TextBoxFor(model => searchParametersForRealtor.HeightTo, new { @class = "input-mini" })
                </div>
            </div>
        </div>

        <div class="realtor-sortArea">
            <div class="span5">
                <label>Sort </label>
                @Html.DropDownListFor(model => searchParametersForRealtor.SortOrder, sortedOrders as SelectList,  new { @class = "input-large",onchange = @"form.submit();"  })
            </div>
            <div class="span-half-center">
                <p class="createTitle">
                    @Html.ActionLink("Reset filter", "RealEstates", new { ReturnUrl = Request.Url.PathAndQuery })
                </p>
            </div>
        </div>
    </div>
    <div class="span5">
        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Search" class="btn btn-default" />
            </div>
        </div>
    </div>





}
<div class="realtor-ItemsArea">
    For list
</div>
<p class="createTitle">
    @Html.ActionLink("Create New", "CreateRealEstate", new { ReturnUrl = Request.Url.PathAndQuery })
</p>

@foreach (var realEstate in Model.RealEstates)
{
<div class="realtor-itemAreaView-content">
    <div class="image">Меню</div>
    <div class="info">
        <div class="column2_3">
            <div class="item-address">
                @realEstate.StreetName @realEstate.Building, кв @realEstate.Appartment; @realEstate.DistrictName
            </div>
        </div>
        <div class="column1_3">
            <div class="item-price">
                @realEstate.Price.ToString("C0", CultureInfo.CreateSpecificCulture("en-US"))
            </div>
        </div>
        <div>
            @realEstate.RoomNumber комн, @realEstate.Floor этаж, @realEstate.Height эт.,
        </div>
        <div>
            площа @realEstate.Area м²
        </div>
        <div class="item-description">
            @realEstate.Description
        </div>
        <div class="item-realtor">
            РИЕЛТОР @realEstate.RealtorName ; @realEstate.RealtorEmail
        </div>

        <div>
            дата добавления @realEstate.CreationDate.ToString("d")
        </div>
    </div>
    @if (realEstate.IsOwner && !realEstate.IsSold)
    {
        <!--div id="content2">Основное содержимое 2</div-->
        <div class="span5">
            @using (Html.BeginForm("Delete", "Admin", FormMethod.Post, new { onclick = "return confirm('Are sure wants to delete ?');" }))
            {

                <input type="submit" value="Edit" />
            }
        </div>
        @if (!realEstate.IsSold)
        {

        <div class="span5">
            @using (Html.BeginForm("MarkAsSold","", FormMethod.Post, new { onclick = "return confirm('Are sure wants to mark as sold ?');" }))
            {

                <input type="submit" value="Mark as sold" />
}
        </div>
        }
        <div class="span5">
            @using (Html.BeginForm("Delete", "Admin", FormMethod.Post, new { onclick = "return confirm('Are sure wants to delete ?');" }))
            {

                <input type="submit" value="Delete" />
            }
        </div>
    }
</div>
}
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}